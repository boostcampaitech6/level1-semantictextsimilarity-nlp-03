# ğŸ†**Level1 Project - STS(Semantic Text Similarity)**


## âœï¸**ëŒ€íšŒ ì†Œê°œ**

|íŠ¹ì§•|ì„¤ëª…|
|:--:|--|
|**ëŒ€íšŒ ì£¼ì²´**|ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ìº í”„ AI-Tech 6ê¸° NLPíŠ¸ë™ì˜ level1 ë„ë©”ì¸ ê¸°ì´ˆ ëŒ€íšŒì…ë‹ˆë‹¤.|
|**ëŒ€íšŒ ì„¤ëª…**|ë‘ ë¬¸ì¥ì´ ì£¼ì–´ì¡Œì„ ë•Œ ë‘ ë¬¸ì¥ì— ëŒ€í•œ STS(Semantic Text Simliarity)ë¥¼ ì¶”ë¡ í•˜ëŠ” ëŒ€íšŒë¡œ Kaggleê³¼ Daconê³¼ ê°™ì´ competition í˜•íƒœë¡œ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.|
|**ë°ì´í„° êµ¬ì„±**|ë°ì´í„°ëŠ” slack ëŒ€í™”, ë„¤ì´ë²„ ì˜í™” í›„ê¸°, êµ­ë¯¼ ì²­ì› ë¬¸ì¥ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. Train(9324ê°œ), Dev(550ê°œ), Test(1100ê°œ) |
|**í‰ê°€ ì§€í‘œ**|ëª¨ë¸ì˜ í‰ê°€ì§€í‘œëŠ” í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜(Pearson correlation coefficient)ë¡œ ì¸¡ì •í–ˆìŠµë‹ˆë‹¤.|

<br>

## ğŸ–ï¸**Leader Board**
### **ğŸ¥ˆPrivate Leader Board(2ìœ„)**
![Alt text](./markdownimg/image-1.png)

### **ğŸ¥‰Public Leader Board(3ìœ„)**
![Alt text](./markdownimg/image.png)


<br>

## ğŸ‘¨â€ğŸ’»Team & Members

* **Teamëª…** : 369 [NLP 3ì¡°]


### ğŸ§š**Members**

|ê¹€ë™í˜„|ê¹€ìœ ë¯¼|ë°•ì‚°ì•¼|ì´ì¢…ì›|í™©ê¸°ì¤‘|í™©ì˜ˆì›|
|:--:|:--:|:--:|:--:|:--:|:--:|
|![Alt text](./markdownimg/image-3.png)|![Alt text](./markdownimg/image-4.png)|![Alt text](./markdownimg/image-5.png)|![Alt text](./markdownimg/image-2.png)|![Alt text](./markdownimg/image-6.png)|![Alt text](./markdownimg/image-7.png)|
|[Github](https://github.com/valofosho)|[Github](https://github.com/miniminii)|[Github](https://github.com/SanyaPark)|[Github](https://github.com/jongwoncode)|[Github](https://github.com/merri4)|[Github](kjhwang97@gmail.com)|
|[Mail](whgdk1880@gmail.com)|[Mail](sksdjssl3148@gmail.com)|[Mail](vs501kr@gmail.com)|[Mail](uj02030@naver.com )|[Mail](kjhwang97@gmail.com)|[Mail](hwyewon@gmail.com)|


<br>

### ğŸ’¯**Our Team's Goal**
> íŒ€ ë‹¨ìœ„ì˜ í”„ë¡œì íŠ¸ì¸ë§Œí¼ ìµœëŒ€í•œ ë‹¤ì–‘í•œ ì‹œë„ë¥¼ ë¶„ì—…í•˜ì—¬ ì„œë¡œì˜ ë‚´ìš©ì´ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë•Œ ì—…ë¬´ë¥¼ ì •í™•í•œ ê¸°ì¤€ìœ¼ë¡œ êµ¬ë¶„í•˜ê¸°ë³´ë‹¤ ëª¨ë‘ê°€ ììœ ë¡­ê²Œ EDAë¶€í„° ì „ì²˜ë¦¬, ëª¨ë¸ ì‹¤í—˜, ëª¨ë¸ íŠœë‹ê¹Œì§€ end-to-endë¡œ ê²½í—˜í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í˜‘ì—…í•˜ì˜€ìŠµë‹ˆë‹¤. â€˜í•˜ë‚˜ì— ê½‚íˆë©´ ëê¹Œì§€ íŒë‹¤â€™ëŠ” ê³µí†µì ì„ ê°€ì§„ ì €í¬ íŒ€ì›ë“¤ì˜ ê°•í•œ ì±…ì„ê°ê³¼ ì•„ì´ë””ì–´ë¥¼ í–¥í•œ ëˆì§ˆê¸´(?) ì• ì • ë•ë¶„ì— ì„±ê³µì ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ë§ˆë¬´ë¦¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

<br>

### ğŸ‘¼**Member's role**
|**Member**|**Role**|
|--|--|
|**ê¹€ë™í˜„**|**EDA**(`ë°ì´í„° ì…‹ íŠ¹ì„± ë¶„ì„`), **ë°ì´í„° ì¦ê°•**(`back translation`), **ëª¨ë¸ë§ ë° íŠœë‹**(`Bert, Roberta, Albert, SBERT, WandB`)|
|**ê¹€ìœ ë¯¼**|**EDA**(`label-pred ë¶„í¬ ë¶„ì„`), **ë°ì´í„° ì¦ê°•**(`back translation/nnp_sl_masking/ì–´ìˆœë„ì¹˜/ë‹¨ìˆœë³µì œ`), **ëª¨ë¸ íŠœë‹**(`roberta-large, kr-electra-discriminator`)|
|**ë°•ì‚°ì•¼**|**EDA**(`label ë¶„í¬ ë° ë¬¸ì¥ ê¸¸ì´ ë¶„ì„`), **ë°ì´í„° ì¦ê°•**(`sentence swap`), **ëª¨ë¸ë§ ë° íŠœë‹**(`KoSimCSE-roberta, í•´ë‹¹ ëª¨ë¸ ê¸°ë°˜ Siamese Network ì ìš© ëª¨ë¸`)|
|**ì´ì¢…ì›**|**EDA**(`label ë¶„í¬ ë¶„ì„, label-pred ë¶„í¬ ë¶„ì„`), **ë°ì´í„° ì „ì²˜ë¦¬**(`hanspell`), **ë°ì´í„° ì¦ê°•**(`/swap sentence/copied sentence/SR/random masking`), **ëª¨ë¸ íŠœë‹**(`roberta-large, electra-kor-base, kr-electra-discriminator`), **ì•™ìƒë¸”**(`soft voting, weight voting`), **ì½”ë“œ ë¦¬íŒ©í† ë§**|
|**í™©ê¸°ì¤‘**|**ë°ì´í„° ì „ì²˜ë¦¬**(`ë„ì–´ì“°ê¸° í†µì¼`), **ë°ì´í„° ì¦ê°•**(`ë¶€ì‚¬/ê³ ìœ ëª…ì‚¬ ì œê±° Augmentation`), **ëª¨ë¸ë§**(`KoSimCSE-roberta`), **ì•™ìƒë¸”**(`variance-based ensemble`)|
|**í™©ì˜ˆì›**|**ëª¨ë¸ë§ ë° íŠœë‹**(`RoBERTa, T5, SBERT`), **ëª¨ë¸ ê²½ëŸ‰í™”**(`Roberta-large with deepspeed`)|

<br>

## ğŸƒ**Project process**

### ğŸ–¥ï¸ Project Introduction
|**ê°œìš”**|**Description**|
|:--:|--|
|**í”„ë¡œì íŠ¸ ì£¼ì œ** | **`STS(Semantic Text Similarity)`** : ë‘ ë¬¸ì¥ì˜ ìœ ì‚¬ë„ ì •ë„ë¥¼ ìˆ˜ì¹˜ë¡œ ì¶”ë¡ í•˜ëŠ” Task |
|**í”„ë¡œì íŠ¸ ëª©í‘œ**| ë‘ ë¬¸ì¥(sentence1, sentence2)ì´ ì£¼ì–´ì¡Œì„ ë•Œ, ì´ ë‘ ë¬¸ì¥ì˜ ìœ ì‚¬ë„ë¥¼ 0~5ì‚¬ì´ì˜ ì ìˆ˜ë¡œ ì¶”ë¡ í•œëŠ” AI ëª¨ë¸ ì œì‘.
|**í”„ë¡œì íŠ¸ í‰ê°€ì§€í‘œ**|ì‹¤ì œ ê°’ê³¼ ì˜ˆì¸¡ê°’ì˜ í”¼ì–´ìŠ¨ ìƒê´€ ê³„ìˆ˜(**Pearson Correlation Coefficient**)|
|**ê°œë°œ í™˜ê²½**|**`GPU` : Tesla V100 Server 6ëŒ€**, **`IDE` : Vscode, Jupyter Notebook**|
|**í˜‘ì—… í™˜ê²½**|**`Notion`**(ì§„í–‰ ìƒí™© ê³µìœ ), **`Figma`**(ì§„í–‰ ìƒí™© ì‹œê°í™” ê³µìœ ), **`Github`**(ì½”ë“œ ë° ë°ì´í„° ê³µìœ ), **`Slack`**(ì‹¤ì‹œê°„ ì†Œí†µ) |

<br>

### ğŸ“…**Project TimeLine**

* í”„ë¡œì íŠ¸ëŠ” 2023-12-11 ~ 2023 12-21 ì•½ 11ì¼ê°„ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.

![Alt text](./markdownimg/image-8.png)

<br>

### ğŸ•µï¸**What we did**

* í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ë‹¨ê³„ë³„ë¡œ ì‹¤í—˜í•´ ë³´ê³  ì ìš©í•´ ë³¸ ë‚´ìš©ë“¤ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

|**Process**|**What we did**|
|:--:|--|
|**EDA**|ë°ì´í„° ë¶„í¬ ë¶„ì„, Baseline ëª¨ë¸ ì˜ˆì¸¡ê³¼ ì‹¤ì œê°’ ì°¨ì´ ë¶„ì„|
|**Preprocessing**|`emotion normalize`, `repeat normalize`, `íŠ¹ìˆ˜ë¬¸ì ì œê±°`, `ì˜ì–´ ì†Œë¬¸ì ì²˜ë¦¬`, `hanspell(ë§ì¶¤ë²•ê²€ì‚¬)`|
|**Augmentation**|`SR(Synonym Replacement)`, `Swap Sentence`, `Copied Sentence`, `NNP, SL Masking`, `Back Translation`, `ì–´ìˆœ ë„ì¹˜`, `ë‹¨ìˆœ ë³µì œ`|
|**Experiment Model**|`klue/RoBERTa-base`, `klue/RoBERTa-large`, `klue/bert-base`, `monologg/KoELECTRA-base`, `KETI-AIR/ke-t5-base`, `xlm-roberta-large`, `snunlp/KR-SBERT-V40K-klueNLI-augSTS`, `kykim/electra-kor-base`, `snunlp/KR-ELECTRA-discriminator`, `BM-K/KoSimCSE-roberta`, `rurupang/roberta-base-finetuned-sts`|
|**Hyper paramter tunning & Mornitoring**| `Wandb Sweep`|
|**Ensemble**|`weight voting`, `soft voting`|


<br>

### **ğŸ“ŠDataSet**

|**Version**|**Description**|
|:--:|--|
|**AugmentationV1**|ì›ë³¸ ë°ì´í„°ì—ì„œ label>=4ì¸ ë°ì´í„° ë‹¨ìˆœ ì¦ê°•.|
|**AugmentationV2**|`ì›ë³¸ ë°ì´í„°` + `ë§ì¶¤ë²• ê²€ì‚¬ ë°ì´í„°` + `SR` + `Swap Sentence` + `Copied Sentence`|
|**AugmentationV3**|`AugmentationV2` + `NNP, SL Masking`|

* ë°ì´í„° ì¦ê°• ê³¼ì •ì—ì„œ ë¼ë²¨ ë¶„í¬ë¥¼ ê· í˜•ìˆê²Œ ë§ì¶”ê³ ì **ë¼ë²¨ë³„ ì¦ê°• ë¹„ìœ¨ì„ ì¡°ì •**í•˜ì˜€ìŠµë‹ˆë‹¤.
![Alt text](./markdownimg/image-9.png)

<br>



### ğŸ¤–**Ensemble Model**

* ìµœì¢…ì ìœ¼ë¡œ 5ê°œì˜ ëª¨ë¸ì„ ì•™ìƒë¸”ì— ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

|**Model**|**Learing Rate**|**Batch Size**|**loss**|**epoch**|**Data Cleaning**|**Data Augmentation**|**Public Pearson**|**Scheduler**|**Ensemble Weight**|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|**klue/RoBERTa-large**|1e-5|16|L1|5|Spell Check|AugmentationV2|0.9125||0.9125|
|**klue/RoBERTa-large**|1e-5|16|MSE|2|Spell Check|AugmentationV3|0.9166||0.9166|
|**kykim/electra-kor-base**|2e-5|32|L1|23|Spell Check|AugmentationV2|0.9216|CosineAnnealingWarmRestarts|0.9216|
|**snunlp/KR-ELECTRA-discriminator**|1e-5|32|L1|15||AugmentationV1|0.9179||0.9179|
|**snunlp/KR-ELECTRA-discriminator**|2e-5|32|L1|15|Spell Check|AugmentationV2|0.9217|CosineAnnealingWarmRestarts|0.9217|

<br>

## **ğŸ“Project Structure**

### **ğŸ“ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ëª…**
* í•™ìŠµ ë°ì´í„° ê²½ë¡œ : `./data`
* í•™ìŠµ ì½”ë“œ ê²½ë¡œ : `./code`
* ëª¨ë¸ Config ê²½ë¡œ : `./code/config`
* í•™ìŠµëœ ëª¨ë¸ ìƒì„± ê²½ë¡œ : `./model`
* ì¶”ë¡  ë° ì•™ìƒë¸” ê²°ê³¼ ìƒì„± ê²½ë¡œ : `./result`


### **ğŸ“ğŸ“ì½”ë“œ êµ¬ì¡° ì„¤ëª…**
1. **ë°ì´í„° ì¦ê°• ì½”ë“œ ìœ„ì¹˜** : `./code/augmentation.py`
    - ì¦ê°• ë°ì´í„° ìƒì„± ê²½ë¡œ : `./data/`
    
2. **Config ì„¤ì • ì½”ë“œ ê²½ë¡œ** : `./code/config/`
3. **Model Train ì½”ë“œ ìœ„ì¹˜** : `./code/train.py`
    - ëª¨ë¸ .ptíŒŒì¼ ìƒì„± ê²½ë¡œ : `./model/`
4. **Infer & Ensemble ì½”ë“œ ìœ„ì¹˜** : `./code/infer.py`
    - ì¶”ë¡  ê²°ê³¼ .csvíŒŒì¼ ìƒì„± ê²½ë¡œ : `./result/`

```
ğŸ“level1_semantictextsimilarity-nlp-3
â”œâ”€code
â”‚  â”‚  augmentation.py
â”‚  â”‚  dataloader.py
â”‚  â”‚  dataset.py
â”‚  â”‚  inference.py
â”‚  â”‚  learner.py
â”‚  â”‚  model.py
â”‚  â”‚  train.py
â”‚  â”‚  utils.py
â”‚  â”‚  
â”‚  â”œâ”€config
â”‚  â”‚      kr_electraV1_config.py
â”‚  â”‚      kr_electraV2_config.py
â”‚  â”‚      kykim_config.py
â”‚  â”‚      roberta_large_config.py
â”‚  â”‚      roberta_large_nnp_config.py
â”‚  â”‚      
â”‚  â””â”€wrappers
â”‚          config_wrapper.py
â”‚          train_wrapper.py
â”‚          
â”œâ”€data
â”‚      dev.csv
â”‚      dev_spellcheck.csv
â”‚      sample_submission.csv
â”‚      test.csv
â”‚      test_spellcheck.csv
â”‚      train.csv
â”‚      train_augmentV1.csv
â”‚      train_augmentV2.csv
â”‚      train_augmentV3.csv
â”‚      wordnet.pickle
â”‚      
â”œâ”€model
â”‚      klue-roberta-large-nnp.pt
â”‚      klue-roberta-large.pt
â”‚      kykim-electra-kor-base.pt
â”‚      snunlp-KR-ELECTRA-discriminator-V1.pt
â”‚      snunlp-KR-ELECTRA-discriminator-V2.pt
â”‚      
â””â”€result
        ensemle.csv
        klue-roberta-large-nnp.csv
        klue-roberta-large.csv
        kykim-electra-kor-base.csv
        snunlp-KR-ELECTRA-discriminator-V1.csv
        snunlp-KR-ELECTRA-discriminator-V2.csv
```
<br>

## **ğŸ’»How to Start**

### **ğŸ“ŠMake Dataset**
```
# ë°ì´í„° ì¦ê°•
> python ./code/augmentation.py
```

### **ğŸ¤–Train Model**
```
# ./code/config ì—ì„œ í›ˆë ¨ ëª¨ë¸ì˜ config ì„¤ì •
> python ./code/trian.py
```


### **ğŸ¤–Infer or Ensemble Model**
```
# Infer
> python ./code/train.py --mode infer

# Ensemble
> python ./code/train.py --mode ensemble
```

